<!DOCTYPE html>
<html>
  <head>
    <meta name='author' content='Albert Wu'>
    <title>Final review from section 12/5: </title>

    <script src='/public/js/jquery-1.11.3.min.js'></script>
    <script src='/public/js/bootstrap.min.js'></script>

    <link rel='stylesheet' type='text/css' href='/public/css/bootstrap.min.css'>
    <link rel='stylesheet' type='text/css' href='/public/css/style.css'>
    <link rel='stylesheet' type='text/css' href='/public/css/mono-green.css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <script src='/public/js/highlight.pack.js'></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <link rel='stylesheet' type='text/css' href='/public/css/sidebar.css'>
<link rel='stylesheet' type='text/css' href='/public/css/review.css'>
    

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39937584-1', 'albertwu.org');
      ga('send', 'pageview');
    </script>

  </head>
  <body>
    <!-- Top navbar (for small window sizes) -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Albert Wu</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav">
            <li><a href="/cs61a/">CS 61A</a></li>
            <li><a href="/projects/">Projects</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <div class='header'>
      <div class='container'>
        <h1>Final review from section 12/5: -level questions</h1>
      </div>
    </div>

    <!-- Content -->
    <div class='container'>
      <div class='row'>
  <div class='col-md-9' id='content'>
    

<p>These questions were written for my section on 12/5/2014.</p>



  <p>Each question has a "Toggle Solution" button -- click it to
  reveal that question's solution.</p>

  <noscript>You need to <b>enable JavaScript</b> to view the
    solutions.</noscript>

  


<h2 id="scheme">Scheme</h2>


<h3 class="question" id="q1">Question 1</h3>

<p>Implement a function <code>flatten</code> which takes a nested Scheme list and
flattens it. For example,</p>

<pre><code>STk&gt; (flatten &#x27;(1 (2 (3) 4) 5 6))
(1 2 3 4 5 6)</code></pre>

<p>Here is the skeleton code:</p>

<pre><code>(define (flatten lst)
  ; Your code here
  )</code></pre>


    <button id='0' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 0">

<pre><code>(define (flatten lst)
  (cond ((null? lst) nil)
        ((list? (car lst)) (append (flatten (car lst))
                                   (flatten (cdr lst))))
        (else (cons (car lst) (flatten (cdr lst))))
  )
)</code></pre>

<p>This question tests various list manipulation techniques. The solution
is written recursively, with the following cases:</p>

<ul>
  <li>If the list is empty, then flattening it does nothing. Just return an
  empty list.</li>
  <li><p>If the first element of the list is a nested list (<code>(list? (car
  lst))</code>), then append it to the flattened version of the rest of the
  list. For example, for the list</p>

<pre><code>((2 (3) 4) 5 6)</code></pre>

  <p>The first element is <code>(2 (3) 4)</code>, so to get the flattened list, we do
  the following:</p>

  <ol>
    <li>Flatten the first element: <code>(flatten &#x27;(2 (3) 4)) &#x2d;&#x2d;&gt; (2 3 4)</code></li>
    <li>Flatten the rest: <code>(flatten &#x27;(5 6)) &#x2d;&#x2d;&gt; (5 6)</code></li>
    <li>Join the results by using <code>append</code>, e.g.</li>
  </ol></li>
  <li>Otherwise, the first element of the list is not a list. Simply leave
  it as is and flatten the rest of list.</li>
</ul>

</div>
    


<h2 id="interpreters">Interpreters</h2>


<h3 class="question" id="q2">Question 2</h3>

<p>Find the <code>Pair</code> representation of the following Scheme expression:</p>

<pre><code>(1 2 . (3 . 4))</code></pre>


    <button id='1' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 1">

<p>First, notice that this is the same thing as</p>

<pre><code>(1 2 3 . 4)</code></pre>

<p>Then the <code>Pair</code> representation is</p>

<pre><code>Pair(1,
     Pair(2,
          Pair(3, 4)))</code></pre>

<p>Notice that this is different than the <code>Pair</code> representation for <code>(1 2
3 4)</code>, which would be</p>

<pre><code>Pair(1,
     Pair(2,
          Pair(3,
               Pair(4, nil))))</code></pre>

</div>
    

<h3 class="question" id="q3">Question 3</h3>

<p><em>From Fall 2013</em>: Convert the following Scheme expression into its Pair
representation (i.e. what <code>scheme_read</code> would return):</p>

<pre><code>(+ 3 &#x27;(4 8) &#x27;hi)</code></pre>


    <button id='2' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 2">

<p>Let <code>P</code> denote <code>Pair</code>. The solution is</p>

<pre><code>P(&#x27;+&#x27;,
  P(3,
    P( P(&#x27;quote&#x27;, P(P(4, P(8, nil)), nil)),
      P( P(&#x27;quote&#x27;, P(&#x27;hi&#x27;, nil)),
        nil)))):</code></pre>

<p>First ignore the nested lists and quotes:</p>

<pre><code>(+ 3 ___  ___)</code></pre>

<p>This would generate the following Pair representation</p>

<pre><code>P(&#x27;+&#x27;, P(3, P(___, P(___, nil))))</code></pre>

<p>Now we just have to fill in the two blanks. The first blank corresponds
to <code>&#x27;(4 8)</code>. This has a Pair representation like this</p>

<pre><code>P(&#x27;quote&#x27;, P( P(4, P(8, nil)) , nil))</code></pre>

<p>(Review Q1 of Proj4 if you are unsure why the quote was converted in this way). The
second blank correpsonds to <code>&#x27;hi</code> and it gets converted into</p>

<pre><code>P(&#x27;quote&#x27;, P(&#x27;hi&#x27;, nil))</code></pre>

<p>Put these together to get the final solution.</p>

</div>
    

<h3 class="question" id="q4">Question 4</h3>

<p>Count how many times <code>scheme_eval</code> and <code>scheme_apply</code> are called for
the following expression:</p>

<pre><code>(+ 1 (&#x2d; 2 3))</code></pre>


    <button id='3' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 3">

<ul>
  <li><code>scheme_apply</code> is called 2 times. Observe that there are only two
  function calls in this expression: <code>+</code> and <code>&#x2d;</code>.</li>
  <li><p><code>scheme_eval</code> is called 7 times:</p>

  <ol>
    <li>Once for the entire expression <code>(+ 1 (&#x2d; 2 3))</code></li>
    <li>Once for <code>+</code></li>
    <li>Once for <code>1</code></li>
    <li>Once for <code>(&#x2d; 2 3)</code>. Since this is also a function call, we need
    to evaluate all of its operators and operands:</li>
    <li>Once for <code>&#x2d;</code></li>
    <li>Once for <code>2</code></li>
    <li>Once for <code>3</code>.</li>
  </ol></li>
</ul>

</div>
    

<h3 class="question" id="q5">Question 5</h3>

<p>Given the following function</p>

<pre><code>(define (square x) (* x x))</code></pre>

<p>How many times are <code>scheme_eval</code> and <code>scheme_apply</code> called for the
following expression?</p>

<pre><code>(+ 2 (square 4))</code></pre>


    <button id='4' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 4">

<ul>
  <li><code>scheme_eval</code>: 10 times</li>
  <li><code>scheme_apply</code>: 3 times</li>
</ul>

<p>For apply, a good rule of thumb is to count the number of functions
(primitive and user-defined) that are called. In this case, we call
<code>+</code>, <code>square</code>, and <code>*</code> (when we evaluate the body of <code>square</code>).  Thus,
apply is called 3 times.</p>

<p>For eval, each of the following bullets represents one
call to <code>scheme_eval</code>::</p>

<ul>
  <li><p><code>(+ 2 (square 4))</code></p>

  <ul>
    <li><code>+</code></li>
    <li><code>2</code></li>
    <li><p><code>(square 4)</code></p>

    <ul>
      <li><code>square</code></li>
      <li><code>4</code></li>
      <li><p><code>(* x x)</code></p>

      <ul>
        <li><code>*</code></li>
        <li><code>x</code></li>
        <li><code>x</code></li>
      </ul></li>
    </ul></li>
  </ul></li>
</ul>

<p>Thus, we have a total of 10 calls to <code>scheme_eval</code>.</p>

</div>
    


<h2 id="iterators-and-generators">Iterators and Generators</h2>


<p>Implement an iterable class <code>IndexOf</code>, which takes a string and a
substring in its constructor.  When you iterate over an instance of
<code>IndexOf</code>, it will produce the indices at which the substring occurs in
the string. Consider the following example:</p>

<pre><code>&gt;&gt;&gt; indices = IndexOf(&#x27;aba&#x27;, &#x27;ababaaba&#x27;)
&gt;&gt;&gt; for i in indices:
...     print(i)
0
2
5</code></pre>

<p>The substring <code>&#x27;aba&#x27;</code> occurs at indices 0, 2, and 5 in the string
<code>&#x27;ababaaba&#x27;</code>.</p>

<p><em>Hint</em>: Strings have a method called <code>startswith</code>, which can be used to
check if a string startswith another string. For example:</p>

<pre><code>&gt;&gt;&gt; &#x27;ababaaba&#x27;.startswith(&#x27;aba&#x27;)
True</code></pre>

<p>You may modify the following class definition in any way you like.</p>

<pre><code>class IndexOf:
    def __init__(self, substr, string):
        self.string = string
        self.substr = substr
    &quot;*** YOUR CODE HERE ***&quot;</code></pre>


    <button id='5' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 5">

<p>There are many ways to solve this question. We will present two ways:
1) by using an <code>__iter__</code> and <code>__next__</code> method; and 2) by implementing
<code>__iter__</code> as a generator function.</p>

<p>Here is a solution for using <code>__iter__</code> and <code>__next__</code>:</p>

<pre><code>class IndexOf:
    def __init__(self, substr, string):
        self.string = string
        self.substr = substr
        self.index = 0

    def __iter__(self):
        return self

    def __next__(self):
        while self.index &lt; len(self.string) \
              and not self.string[self.index:].startswith(self.substr):
            self.index += 1
        if self.index &gt;= len(self.string):
            raise StopIteration
        elif self.string[self.index:].startswith(self.substr):
            answer = self.index
            self.index += 1
            return answer</code></pre>

<p>Again, there are many variants to this, but the solutions should all
have the following components:</p>

<ul>
  <li>Have a way to keep track of the current index (<code>self.index</code>)</li>
  <li>Raise a <code>StopIteration</code> error if the index exceeds the length of the
  string. This is how Python will know that the iterator stops.</li>
  <li><p>Move down <code>self.string</code>, one character at a time.</p>

  <ul>
    <li>If the suffix of <code>self.string</code> starting at the current index does
    not start with <code>self.substr</code>, move down <code>self.string</code> until this
    is the case. For example, if we are at index 1 in our string,
    then the suffix starting at index 1 is <code>self.string[1:] =
    &#x27;babaaba&#x27;</code>.</li>
    <li>If the suffix of <code>self.string</code> starting at the current index
    starts with <code>self.substr</code>, then return that index.</li>
  </ul></li>
</ul>

<p>The second way to solve this is to make <code>__iter__</code> a generator
function:</p>

<pre><code>class IndexOf:
    def __init__(self, substr, string):
        self.string = string
        self.substr = substr

    def __iter__(self):
        index = 0
        while index &lt; len(self.string):
            if self.string[index:].startswith(self.substr):
                yield index
            index += 1</code></pre>

<p>Recall that if a function uses a <code>yield</code> statement, it is considered by
Python to be a generator function. When a generator function is called,
it will <strong>return a generator object</strong>. That means when <code>__iter__</code> is
called, it will return a generator object.</p>

<p>The generator itself works as follows:</p>

<ol>
  <li>Move down <code>self.string</code>, one character at a time, while keeping
  track of each index.</li>
  <li>If the suffix starting at the current index starts with
  <code>self.substr</code>, yield that index.</li>
</ol>

<p>Once the while loop terminates, the generator will implicitly raise a
<code>StopIteration</code>, so there is no reason to write <code>raise StopIteration</code>.</p>

</div>
    


<h2 id="streams">Streams</h2>


<h3 class="question" id="q6">Question 6</h3>

<p>Given the following function that returns a stream, what are the first
5 elements of the stream?</p>

<pre><code>(define (my&#x2d;stream)
    (cons&#x2d;stream 2
        (add&#x2d;stream (my&#x2d;stream) (scale&#x2d;stream 2 (my&#x2d;stream)))))</code></pre>


    <button id='6' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 6">

<pre><code>2, 6, 18, 54, 162</code></pre>

<p>First, we write down our stream, with variables filling in the values
we don't know:</p>

<pre><code>s = 2 a b c d</code></pre>

<p>Notice that, to compute the rest, we add together two streams: the
original stream, plus the original stream scaled by 2. This looks like
this:</p>

<pre><code>s = 2 | a b  c  d
&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;
      | 2 a  b  c
    + | 4 2a 2b 2c
&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;</code></pre>

<p>We go ahead and add up the first column to get 2 + 4 = 6. Now we know
that <code>a = 6</code>. We can use this new information to calculate <code>b = a + 2a
= 6 + 2(6) = 18</code>. We continue this process to get the remaining
elements:</p>

<pre><code>s = 2 | a b  c  d
&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;
      | 2 a  b  c
    + | 4 2a 2b 2c
&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;&#x2d;
      | 6 18 54 162</code></pre>

</div>
    

<h3 class="question" id="q7">Question 7</h3>

<p>Implement a function <code>num&#x2d;stream</code> that returns a Stream whose elements
have the following pattern:</p>

<pre><code>1, 1, 2, 1, 2, 3, 1, 2, 3, 4, ...
_  ____  _______  __________</code></pre>

<p>A skeleton has been provided:</p>

<pre><code>(define (num&#x2d;stream)
    (define (helper i j)
        (cons&#x2d;stream ______
            _______________
            _______________
            _______________
    (helper ______ ______)
)</code></pre>


    <button id='7' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>

    <div class="solution 7">

<p>First, notice the pattern of the sequence:</p>

<pre><code>1, 1, 2, 1, 2, 3, 1, 2, 3, 4, ...
_  ____  _______  __________
1  2     3        4</code></pre>

<p>We can use <code>i</code>  to keep track of which block we're in and use <code>j</code> to
keep track of where we are in that block:</p>

<pre><code>s: 1, 1, 2, 1, 2, 3, 1, 2, 3, 4, ...
   _  ____  _______  __________
i: 1  2  2  3  3  3  4  4  4  4
j: 1  1  2  1  2  3  1  2  3  4</code></pre>

<p>It follows that <code>j</code> should never be greater than <code>i</code>. With this, we can
complete our solution:</p>

<pre><code>(define (num&#x2d;stream)
    (define (helper i j)
        (cons&#x2d;stream j
            (if (&gt;= j i) (helper (+ i 1) 1)
                         (helper (i (+ j 1))))))
    (helper 1 1)
)</code></pre>

<p>In the rest of the stream, when <code>j &gt;= i</code>, then <code>i</code> should move onto the next
block (<code>(+ i 1)</code>), and <code>j</code> should restart to 1 (since it's the start of
the new block).</p>

</div>
    


  </div>

  <div class='col-md-3'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      Final review from section 12/5: 
<hr/>
      <ul>
  <li><a href="#scheme">Scheme</a></li>
  <ul>
  <li><a href="#q1">Question 1</a></li>
</ul>

  <li><a href="#interpreters">Interpreters</a></li>
  <ul>
  <li><a href="#q2">Question 2</a></li>
  <li><a href="#q3">Question 3</a></li>
  <li><a href="#q4">Question 4</a></li>
  <li><a href="#q5">Question 5</a></li>
</ul>

  <li><a href="#iterators-and-generators">Iterators and Generators</a></li>
  <li><a href="#streams">Streams</a></li>
  <ul>
  <li><a href="#q6">Question 6</a></li>
  <li><a href="#q7">Question 7</a></li>
</ul>

</ul>

    </nav>
  </div>
</div>
    </div>
  </body>

  <script>
$(document).ready(function() {
  $('.sidebar ul').addClass('nav nav-stacked');
  $('body').scrollspy({
    target: '.sidebar',
  });
  var affixOffset = 50;
  $('.sidebar').affix({
    offset: {
      top: $('#content').offset().top - affixOffset
    }
  });
  $('.sidebar').css('top', affixOffset);
});
</script>
<script src='/public/js/toggle.js'></script>
</html>
